{% extends "base.html" %}

{% block content %}
<section class="hero">
    <h1>Bulk UUID Generation</h1>
    <p>Generate up to 1000 UUIDs with a single click</p>
</section>

<section class="bulk-generator">
    <div class="card">
        <h2>Generate UUIDs in Bulk</h2>
        
        <form id="bulk-form">
            <div class="form-group">
                <label for="bulk-type">
                    UUID Type:
                    <div class="tooltip-container">
                        <span class="info-icon">?</span>
                        <span class="tooltip-text">
                            <strong>UUID v1:</strong> Time-based UUIDs generated in sequence.<br>
                            <strong>UUID v4:</strong> Random UUIDs, each independently generated.
                        </span>
                    </div>
                </label>
                <select id="bulk-type" name="type">
                    <option value="v4">UUID v4 (random)</option>
                    <option value="v1">UUID v1 (time-based)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="count">
                    Number of UUIDs:
                    <div class="tooltip-container">
                        <span class="info-icon">?</span>
                        <span class="tooltip-text">
                            Choose how many UUIDs to generate at once. Maximum is 1000 per request.
                        </span>
                    </div>
                </label>
                <input type="number" id="count" name="count" min="1" max="1000" value="10">
            </div>
            
            <button type="submit" class="btn primary">Generate Bulk UUIDs</button>
        </form>
        
        <div id="bulk-result" class="result">
            <h3>Generated UUIDs:</h3>
            <div class="action-buttons">
                <button id="copy-all" class="btn-small">Copy All</button>
                <button id="download-txt" class="btn-small">Download .txt</button>
                <button id="download-csv" class="btn-small">Download .csv</button>
                <button id="download-json" class="btn-small">Download .json</button>
            </div>
            
            <div class="format-options">
                <label>Display Format:</label>
                <select id="display-format">
                    <option value="list">Simple List</option>
                    <option value="numbered">Numbered List</option>
                    <option value="quoted">With Quotes</option>
                    <option value="array">Array Format</option>
                </select>
            </div>
            
            <textarea id="bulk-uuids" readonly rows="15"></textarea>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const bulkForm = document.getElementById('bulk-form');
    const bulkResult = document.getElementById('bulk-result');
    const bulkUuids = document.getElementById('bulk-uuids');
    const copyAllBtn = document.getElementById('copy-all');
    const displayFormat = document.getElementById('display-format');
    
    let generatedUuids = [];
    
    // Form submission
    bulkForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        const formData = new FormData(bulkForm);
        
        fetch('/generate-bulk', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            generatedUuids = data.uuids;
            updateDisplay();
            bulkResult.style.display = 'block';
        })
        .catch(error => {
            console.error('Error:', error);
            alert('An error occurred while generating UUIDs.');
        });
    });
    
    // Update display based on the selected format
    function updateDisplay() {
        const format = displayFormat.value;
        let output = '';
        
        switch(format) {
            case 'list':
                output = generatedUuids.join('\n');
                break;
            case 'numbered':
                output = generatedUuids.map((uuid, index) => `${index + 1}. ${uuid}`).join('\n');
                break;
            case 'quoted':
                output = generatedUuids.map(uuid => `"${uuid}"`).join('\n');
                break;
            case 'array':
                output = '[\n  ' + generatedUuids.map(uuid => `"${uuid}"`).join(',\n  ') + '\n]';
                break;
        }
        
        bulkUuids.value = output;
    }
    
    // Change display format
    displayFormat.addEventListener('change', updateDisplay);
    
    // Copy all UUIDs
    copyAllBtn.addEventListener('click', function() {
        bulkUuids.select();
        document.execCommand('copy');
        showToast('UUIDs copied to clipboard');
    });
    
    // Download as TXT
    document.getElementById('download-txt').addEventListener('click', function() {
        downloadFile('uuids.txt', generatedUuids.join('\n'), 'text/plain');
    });
    
    // Download as CSV
    document.getElementById('download-csv').addEventListener('click', function() {
        downloadFile('uuids.csv', generatedUuids.join('\n'), 'text/csv');
    });
    
    // Download as JSON
    document.getElementById('download-json').addEventListener('click', function() {
        downloadFile('uuids.json', JSON.stringify(generatedUuids, null, 2), 'application/json');
    });
    
    // Function to download a file
    function downloadFile(filename, content, contentType) {
        const blob = new Blob([content], { type: contentType });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }
    
    // Toast notification
    function showToast(message) {
        const toast = document.createElement('div');
        toast.classList.add('toast');
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(function() {
            toast.classList.add('show');
        }, 100);
        
        setTimeout(function() {
            toast.classList.remove('show');
            setTimeout(function() {
                document.body.removeChild(toast);
            }, 300);
        }, 3000);
    }
});
</script>
{% endblock %} 